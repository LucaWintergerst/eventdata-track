{
  "meta": {
    "short-description": "Track for simulation of event-based use cases.",
    "description": "This track contains data generators and associated queries and aggregations to allow simulation of event-based use cases."
  },
  "indices": [
    {
      "name": "elasticlogs",
      "types": [
        {
          "name": "logs",
          "mapping": "mappings.json"
        }
      ]
    }
  ],
  "#COMMENT": "'operations' just define all possible operations but this is not the actual execution schedule. The execution is defined in the 'challenges' block and it just refers to the defined operations. The intention between this separation is to allow reuse of operations",
  "operations": [
    {
      "name": "index-append-1000",
      "operation-type": "index",
      "param-source": "elasticlogs_bulk",
      "bulk-size": 1000
    },
    {
      "name": "index-append-500",
      "operation-type": "index",
      "param-source": "elasticlogs_bulk",
      "bulk-size": 500
    },
    {
      "name": "index-append-250",
      "operation-type": "index",
      "param-source": "elasticlogs_bulk",
      "bulk-size": 250
    },
    {
      "name": "index-append-125",
      "operation-type": "index",
      "param-source": "elasticlogs_bulk",
      "bulk-size": 125
    },
    {
      "name": "index-append-1000-elasticlogs_write",
      "operation-type": "index",
      "param-source": "elasticlogs_bulk",
      "index": "elasticlogs_write",
      "bulk-size": 1000
    },
    {
      "name": "create_elasticlogs_write",
      "operation-type": "createindex",
      "index_name": "elasticlogs-000001",
      "alias": "elasticlogs_write",
      "index_template_body": {
        "template": "elasticlogs*",
        "settings": {
          "index.refresh_interval": "5s",
          "index.codec": "best_compression",
          "index.number_of_replicas": 0,
          "index.number_of_shards":1
        },
        "mappings": {
          "logs": {
            "properties": {
              "@timestamp": { "type": "date" },
              "@message": { "type": "text", "index": false },
              "agent": { "type": "keyword", "ignore_above": 256 },
              "bytes": { "type": "integer" },
              "clientip": { "type": "ip" },
              "httpversion": { "type": "keyword", "ignore_above": 256 },
              "response": { "type": "short" },
              "verb": { "type": "keyword", "ignore_above": 256 },
              "geoip" : {
                "properties" : {
                  "country_name" : { "type": "keyword" },
                  "location" : { "type": "geo_point" }
                }
              },
              "useragent": {
                "properties": {
                  "name": { "type": "keyword", "ignore_above": 256 },
                  "os": { "type": "keyword", "ignore_above": 256 },
                  "os_name": { "type": "keyword", "ignore_above": 256 }
                }
              },
              "request": {
                "norms": false,
                "type": "text",
                "fields": {
                  "keyword": { "ignore_above": 256, "type": "keyword" }
                }
              },
              "referrer": {
                "norms": false,
                "type": "text",
                "fields": {
                  "keyword": { "ignore_above": 256, "type": "keyword" }
                }
              }
            },
            "_all": { "enabled": false }
          }
        },
        "aliases": {}
      },
      "index_template_name": "elasticlogs"
    },
    {
      "name": "rollover_elasticlogs_write",
      "operation-type": "rollover",
      "alias": "elasticlogs_write",
      "body": {
        "conditions": {
          "max_age":   "1d",
          "max_docs":  1000000
        }
      }
    },
    {
      "name": "scanquery_elasticlogs_1m",
      "operation-type": "search",
      "index": "elasticlogs-*",
      "pages": 1000,
      "results-per-page": 10000,
      "body": {
        "query": {
          "range" : {
            "@timestamp" : {
              "gte" : "now-1m",
              "lt" :  "now"
            }
          }
        }
      }
    },
    {
      "name": "scanquery_elasticlogs_5m",
      "operation-type": "search",
      "index": "elasticlogs-*",
      "pages": 1000,
      "results-per-page": 10000,
      "body": {
        "query": {
          "range" : {
            "@timestamp" : {
              "gte" : "now-5m",
              "lt" :  "now"
            }
          }
        }
      }
    }
  ],
  "challenges": [
    {
      "name": "append-no-conflicts",
      "default": true,
      "description": "Indexes using 8 clients and runs indexing with a batch size of 1000 for 10 minutes. IDs are autogenerated by Elasticsearcg, meaning there are no conflicts.",
      "index-settings": {
        "index.number_of_replicas": 0,
        "index.number_of_shards":1
      },
      "schedule": [
        {
          "operation": "index-append-1000",
          "warmup-time-period": 0,
          "time-period": 600,
          "clients": 8
        }
      ]
    },
    {
      "name": "local-test",
      "description": "Indexes using 4 clients and runs indexing with a batch size of 1000 for 2 minutes. IDs are autogenerated by Elasticsearcg, meaning there are no conflicts.",
      "index-settings": {
        "index.number_of_replicas": 0,
        "index.number_of_shards":1
      },
      "schedule": [
        {
          "operation": "index-append-1000",
          "warmup-time-period": 0,
          "time-period": 120,
          "clients": 4
        }
      ]
    },
    {
      "name": "append-no-conflicts-varying-bulk-size",
      "description": "Indexes using 8 clients and runs 4 different batchsizes for 5 minutes each. IDs are autogenerated by Elasticsearcg, meaning there are no conflicts.",
      "index-settings": {
        "index.number_of_replicas": 0,
        "index.number_of_shards":1
      },
      "schedule": [
        {
          "operation": "index-append-125",
          "warmup-time-period": 0,
          "time-period": 300,
          "clients": 8
        },
        {
          "operation": "index-append-250",
          "warmup-time-period": 0,
          "time-period": 300,
          "clients": 8
        },
        {
          "operation": "index-append-500",
          "warmup-time-period": 0,
          "time-period": 300,
          "clients": 8
        },
        {
          "operation": "index-append-1000",
          "warmup-time-period": 0,
          "time-period": 300,
          "clients": 8
        }
      ]
    },
    {
      "name": "append-no-conflicts-index-only",
      "description": "Indexes using 8 threads during 30 minutes. IDs are autogenerated by Elasticsearcg, meaning there are no conflicts.",
      "index-settings": {
        "index.number_of_replicas": 0,
        "index.number_of_shards":1
      },
      "schedule": [
        {
          "operation": "index-append-1000",
          "warmup-time-period": 0,
          "time-period": 1800,
          "clients": 8
        }
      ]
    },
    {
      "name": "test",
      "description": "Runs through and tests all parameter sources and runners.",
      "index-settings": {
        "index.number_of_replicas": 0,
        "index.number_of_shards":1
      },
      "meta": {
        "high_level_parameter": "test"
      },
      "schedule": [
        {
          "operation": "create_elasticlogs_write",
          "clients": 1,
          "warmup-iterations": 0,
          "iterations": 1
        },
        {
          "parallel": {
            "warmup-time-period": 0,
            "time-period": 180,
            "tasks": [
              {
                "operation": "index-append-1000-elasticlogs_write",
                "target-throughput": 4,
                "clients": 4,
                "meta": {
                  "batch_size": 1000,
                  "target_indexing_rate": 4000
                }
              },
              {
                "operation": "rollover_elasticlogs_write",
                "target-interval": 30
              },
              {
                "operation": "scanquery_elasticlogs_1m",
                "target-interval": 60,
                "meta": {
                  "scan_interval_seconds": 60,
                  "target_indexing_rate": 4000
                }
              }
            ]
          }
        }
      ]
    }
  ]
}

